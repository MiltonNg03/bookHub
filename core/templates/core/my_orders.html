{% extends 'core/base.html' %}

{% block title %}Mes Commandes - BookHub{% endblock %}

{% block content %}
<div class="container" style="margin-top: 10vh;">
    <h1>Mes Commandes</h1>
    
    {% if purchased_books or cart_books %}
        <div class="orders-section">
            
            {% if purchased_books %}
                <div>

                    <h2>Livres Achet√©s</h2>
                    <div class="sous_section_two">
                            {% for item in purchased_books %}
                                <div class="book_list" >
                                    {% if item.book.cover_image %}
                                        <img src="{{ item.book.cover_image.url }}" alt="{{ item.book.title }}"style="height:65%" class="book-cover">
                                    {% else %}
                                        <div class="no-image">Pas d'image</div>
                                    {% endif %}
                                    <div class="book-info">
                                        <h3>{{ item.book.title }}</h3>
                                        <p class="author">par {{ item.book.author.name }}</p>
                                        <p class="price">{{ item.price }}‚Ç¨</p>
                                        <p class="quantity">Quantit√©: {{ item.quantity }}</p>
                                        <p class="status purchased">‚úì Achet√©</p>
                                        <p class="order-date">Command√© le {{ item.order.created_at|date:"d/m/Y" }}</p>
                                    </div>
                                </div>
                            {% endfor %}
                    </div>                    
                </div>

            {% endif %}
            
            {% if cart_books %}
                <h2>Livres dans le Panier</h2>

                <div class="sous_section_two">
                    <div class="sous_section_two">
                        {% for item in cart_books %}
                            <div class="book_list">
                                {% if item.book.cover_image %}
                                    <img src="{{ item.book.cover_image.url }}" alt="{{ item.book.title }}" class="book-cover">
                                {% else %}
                                    <div class="no-image">Pas d'image</div>
                                {% endif %}
                                <div class="book-info">
                                    <h3>{{ item.book.title }}</h3>
                                    <p class="author">par {{ item.book.author.name }}</p>
                                    <p class="price">{{ item.book.price }}‚Ç¨</p>
                                    <p class="quantity">Quantit√©: {{ item.quantity }}</p>
                                    <p class="status in-cart">üõí Encore dans le panier</p>
                                    <p class="cart-date">Ajout√© le {{ item.added_at|date:"d/m/Y" }}</p>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                </div>
            {% endif %}
            
        </div>
    {% else %}
        <div class="empty-orders" style="height: 49vh; display: grid; place-items: center;">
            <p>Vous n'avez encore achet√© aucun livre et votre panier est vide.</p>
            <a href="{% url 'book_list' %}" class="btn btn-primary">D√©couvrir nos livres</a>
        </div>
    {% endif %}
</div>

{% endblock %}