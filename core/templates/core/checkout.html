{% extends 'core/base.html' %}

{% block title %}Payment - BookHub{% endblock %}

{% block content %}
<div>
    <h1>Payment</h1>
    
    <div>
        <div>
            <div>
                <div>
                    <h5>Payment Information</h5>
                </div>
                <div>
                    <form method="post" id="payment-form">
                        {% csrf_token %}
                        
                        <div>
                            <label>Name on Card</label>
                            <input type="text" placeholder="John Doe" required>
                        </div>
                        
                        <div>
                            <label>Card Number</label>
                            <input type="text" placeholder="1234 5678 9012 3456" 
                                   pattern="[0-9\s]{13,19}" maxlength="19" required>
                        </div>
                        
                        <div>
                            <div>
                                <label>Expiry Date</label>
                                <input type="text" placeholder="MM/YY" 
                                       pattern="[0-9]{2}/[0-9]{2}" maxlength="5" required>
                            </div>
                            <div>
                                <label>CVV</label>
                                <input type="text" placeholder="123" 
                                       pattern="[0-9]{3,4}" maxlength="4" required>
                            </div>
                        </div>
                        
                        <div>
                            <button type="submit" id="pay-btn">
                                Payment - {{ total }} KES
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        
        <div>
            <div>
                <div>
                    <h5>Order Summary</h5>
                </div>
                <div>
                    <div>
                        <span>Subtotal:</span>
                        <span>{{ total }} KES</span>
                    </div>
                    <div>
                        <span>Shipping:</span>
                        <span>Free</span>
                    </div>
                    <hr>
                    <div>
                        <strong>Total:</strong>
                        <strong>{{ total }} KES</strong>
                    </div>
                </div>
            </div>
            
            <div>
                <div>
                    <h6>Secure Payment</h6>
                    <p>Your payment information is encrypted and secure.</p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.getElementById('payment-form').addEventListener('submit', function(e) {
    const payBtn = document.getElementById('pay-btn');
    const originalText = payBtn.innerHTML;
    
    payBtn.innerHTML = 'Processing...';
    payBtn.disabled = true;
    
    setTimeout(() => {
    }, 1000);
});

document.querySelector('input[placeholder="1234 5678 9012 3456"]').addEventListener('input', function(e) {
    let value = e.target.value.replace(/\s/g, '').replace(/[^0-9]/gi, '');
    let formattedValue = value.match(/.{1,4}/g)?.join(' ') || value;
    e.target.value = formattedValue;
});

document.querySelector('input[placeholder="MM/YY"]').addEventListener('input', function(e) {
    let value = e.target.value.replace(/\D/g, '');
    if (value.length >= 2) {
        value = value.substring(0, 2) + '/' + value.substring(2, 4);
    }
    e.target.value = value;
});
</script>
{% endblock %}